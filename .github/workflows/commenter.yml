name: Commenter

on: [push, pull_request]

jobs:
  run:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v5
    - name: Use Node.js
      uses: actions/setup-node@v6
    - run: npm install
    - run: |
        node lib/comment.js --diff | tee -a results.txt
    - name: Comment PR
      uses: marocchino/sticky-pull-request-comment@v2
      with:
        path: results.txt
    - uses: actions/github-script@v8
      with:
        script: |
          const fs = require('fs');
          const fileContent = fs.readFileSync('results.txt', 'utf8');
          if (fileContent.includes('‚ùå')) {
            core.setFailed('CDN check failed!')
          }
